name: ZenPacks.crosse.OpenBSD

classes:
    OpenBSDDevice:
        base: [zenpacklib.Device]
        label: OpenBSD

    PacketFilter:
        base: [zenpacklib.Component]
        label: Packet Filter
        plural_label: Packet Filter
        properties:
            pfHostId:
                label: Host ID
                order: 1
            pfRunning:
                label: Running
                type: bool
                renderer: Zenoss.render.checkbox
                order: 2
            pfDebug:
                label: Debug Level
                type: int
                enum: {0: "Emergency", 1: "Alert", 2: "Critical", 3: "Error", 4: "Warning", 5: "Notice", 6: "Info", 7: "Debug"}
                order: 3
            pfRuntime:
                label: Runtime
                type: int
                order: 4
            pfCntMatch:
                label: Matches
                type: int
                details_display: false
                grid_display: false
            pfCntBadOffset:
                label: Bad Offsets
                type: int
                details_display: false
                grid_display: false
            pfCntFragment:
                label: Fragments
                type: int
                details_display: false
                grid_display: false
            pfCntShort:
                label: Short Packets
                type: int
                details_display: false
                grid_display: false
            pfCntNormalize:
                label: Normalized Packets
                type: int
                details_display: false
                grid_display: false
            pfCntMemory:
                label: Dropped - Memory Pressure
                type: int
                details_display: false
                grid_display: false
            pfCntTimestamp:
                label: Dropped - Improper Timestamp
                type: int
                details_display: false
                grid_display: false
            pfCntCongestion:
                label: Dropped - Congestion
                type: int
                details_display: false
                grid_display: false
            pfCntIpOption:
                label: Dropped - IP Options
                type: int
                details_display: false
                grid_display: false
            pfCntProtoCksum:
                label: Dropped - Checksum
                type: int
                details_display: false
                grid_display: false
            pfCntStateMismatch:
                label: Dropped - State Mismatch
                type: int
                details_display: false
                grid_display: false
            pfCntStateInsert:
                label: Dropped - State Insert Error
                type: int
                details_display: false
                grid_display: false
            pfCntStateLimit:
                label: Dropped - State Limit
                type: int
                details_display: false
                grid_display: false
            pfCntSrcLimit:
                label: Dropped - Source Limit
                type: int
                details_display: false
                grid_display: false
            pfCntSynproxy:
                label: Dropped - Synproxy
                type: int
                details_display: false
                grid_display: false
            pfCntTranslate:
                label: Dropped - NAT
                type: int
                details_display: false
                grid_display: false
            pfCntNoRoute:
                label: Dropped - No Route
                type: int
                details_display: false
                grid_display: false
            pfStateCount:
                label: State Count
                type: int
                details_display: false
                grid_display: false
            pfStateSearches:
                label: State Searches
                type: int
                details_display: false
                grid_display: false
            pfStateInserts:
                label: State Inserts
                type: int
                details_display: false
                grid_display: false
            pfStateRemovals:
                label: State Removals
                grid_display: false
            pfLogIfName:
                label: Log Interface
                order: 5
            pfLogIfIpBytesIn:
                label: Log Interface - IPv4 Bytes In
                type: int
                renderer: Zenoss.render.bytesString
                details_display: false
                grid_display: false
            pfLogIfIpBytesOut:
                label: Log Interface - IPv4 Bytes Out
                type: int
                renderer: Zenoss.render.bytesString
                details_display: false
                grid_display: false
            pfLogIfIpPktsInPass:
                label: Log Interface - IPv4 Packets In (Pass)
                type: int
                details_display: false
                grid_display: false
            pfLogIfIpPktsInDrop:
                label: Log Interface - IPv4 Packets In (Drop)
                type: int
                details_display: false
                grid_display: false
            pfLogIfIpPktsOutPass:
                label: Log Interface - IPv4 Packets Out (Pass)
                type: int
                details_display: false
                grid_display: false
            pfLogIfIpPktsOutDrop:
                label: Log Interface - IPv4 Packets Out (Drop)
                type: int
                details_display: false
                grid_display: false
            pfLogIfIp6BytesIn:
                label: Log Interface - IPv6 Bytes In
                type: int
                renderer: Zenoss.render.bytesString
                details_display: false
                grid_display: false
            pfLogIfIp6BytesOut:
                label: Log Interface - IPv6 Bytes Out
                type: int
                renderer: Zenoss.render.bytesString
                details_display: false
                grid_display: false
            pfLogIfIp6PktsInPass:
                label: Log Interface - IPv6 Packets In (Pass)
                type: int
                details_display: false
                grid_display: false
            pfLogIfIp6PktsInDrop:
                label: Log Interface - IPv6 Packets In (Drop)
                type: int
                details_display: false
                grid_display: false
            pfLogIfIp6PktsOutPass:
                label: Log Interface - IPv6 Packets Out (Pass)
                type: int
                details_display: false
                grid_display: false
            pfLogIfIp6PktsOutDrop:
                label: Log Interface - IPv6 Packets Out (Drop)
                type: int
                details_display: false
                grid_display: false
            pfSrcTrackCount:
                label: Source Tracking Entries
                type: int
                details_display: false
                grid_display: false
            pfSrcTrackSearches:
                label: Source Tracking Searches
                type: int
                details_display: false
                grid_display: false
            pfSrcTrackInserts:
                label: Source Tracking Inserts
                type: int
                details_display: false
                grid_display: false
            pfSrcTrackRemovals:
                label: Source Tracking Removals
                details_display: false
                grid_display: false
                type: int
                order: 26

class_relationships:
    - OpenBSDDevice 1:MC PacketFilter

device_classes:
    /Server/OpenBSD:
        zProperties:
            zPythonClass: ZenPacks.crosse.OpenBSD.OpenBSDDevice
            zInterfaceMapIgnoreNames: "^pflog.*"
            zCollectorPlugins:
                - crosse.snmp.OpenBSD.PacketFilter
                - zenoss.snmp.NewDeviceMap
                - zenoss.snmp.DeviceMap
                - zenoss.snmp.InterfaceMap
                - zenoss.snmp.RouteMap
                - zenoss.snmp.IpServiceMap
                - zenoss.snmp.HRFileSystemMap
                - zenoss.snmp.CpuMap
                - zenoss.snmp.SnmpV3EngineIdMap

        templates:
            PacketFilter:
                targetPythonClass: ZenPacks.crosse.OpenBSD.PacketFilter
                description: PF monitoring for OpenBSD devices.

                datasources:
                    pfRunning:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.1.1.0
                        component: "${here/id}"
                        datapoints:
                            pfRunning:
                                rrdtype: GAUGE
                    pfRuntime:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.1.2.0
                        component: "${here/id}"
                        datapoints:
                            pfRuntime:
                                rrdtype: GAUGE
                    pfDebug:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.1.3.0
                        component: "${here/id}"
                        datapoints:
                            pfDebug:
                                rrdtype: GAUGE
                    pfCntMatch:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.2.1.0
                        component: "${here/id}"
                        datapoints:
                            pfCntMatch:
                                rrdtype: DERIVE
                    pfCntBadOffset:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.2.2.0
                        component: "${here/id}"
                        datapoints:
                            pfCntBadOffset:
                                rrdtype: DERIVE
                    pfCntFragment:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.2.3.0
                        component: "${here/id}"
                        datapoints:
                            pfCntFragment:
                                rrdtype: DERIVE
                    pfCntShort:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.2.4.0
                        component: "${here/id}"
                        datapoints:
                            pfCntShort:
                                rrdtype: DERIVE
                    pfCntNormalize:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.2.5.0
                        component: "${here/id}"
                        datapoints:
                            pfCntNormalize:
                                rrdtype: DERIVE
                    pfCntMemory:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.2.6.0
                        component: "${here/id}"
                        datapoints:
                            pfCntMemory:
                                rrdtype: DERIVE
                    pfCntTimestamp:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.2.7.0
                        component: "${here/id}"
                        datapoints:
                            pfCntTimestamp:
                                rrdtype: DERIVE
                    pfCntCongestion:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.2.8.0
                        component: "${here/id}"
                        datapoints:
                            pfCntCongestion:
                                rrdtype: DERIVE
                    pfCntIpOption:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.2.9.0
                        component: "${here/id}"
                        datapoints:
                            pfCntIpOption:
                                rrdtype: DERIVE
                    pfCntProtoCksum:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.2.10.0
                        component: "${here/id}"
                        datapoints:
                            pfCntProtoCksum:
                                rrdtype: DERIVE
                    pfCntStateMismatch:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.2.11.0
                        component: "${here/id}"
                        datapoints:
                            pfCntStateMismatch:
                                rrdtype: DERIVE
                    pfCntStateInsert:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.2.12.0
                        component: "${here/id}"
                        datapoints:
                            pfCntStateInsert:
                                rrdtype: DERIVE
                    pfCntStateLimit:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.2.13.0
                        component: "${here/id}"
                        datapoints:
                            pfCntStateLimit:
                                rrdtype: DERIVE
                    pfCntSrcLimit:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.2.14.0
                        component: "${here/id}"
                        datapoints:
                            pfCntSrcLimit:
                                rrdtype: DERIVE
                    pfCntSynproxy:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.2.15.0
                        component: "${here/id}"
                        datapoints:
                            pfCntSynproxy:
                                rrdtype: DERIVE
                    pfCntTranslate:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.2.16.0
                        component: "${here/id}"
                        datapoints:
                            pfCntTranslate:
                                rrdtype: DERIVE
                    pfCntNoRoute:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.2.17.0
                        component: "${here/id}"
                        datapoints:
                            pfCntNoRoute:
                                rrdtype: DERIVE
                    pfStateCount:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.3.1.0
                        component: "${here/id}"
                        datapoints:
                            pfStateCount:
                                rrdtype: GAUGE
                    pfStateSearches:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.3.2.0
                        component: "${here/id}"
                        datapoints:
                            pfStateSearches:
                                rrdtype: DERIVE
                    pfStateInserts:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.3.3.0
                        component: "${here/id}"
                        datapoints:
                            pfStateInserts:
                                rrdtype: DERIVE
                    pfStateRemovals:
                        type: SNMP
                        oid: 1.3.6.1.4.1.30155.1.3.4.0
                        component: "${here/id}"
                        datapoints:
                            pfStateRemovals:
                                rrdtype: DERIVE
                    pfLogIfName:
                        type: SNMP
                        component: "${here/id}"
                        oid: 1.3.6.1.4.1.30155.1.4.1.0
                        datapoints:
                            pfLogIfName:
                                rrdtype: DERIVE
                    pfLogIfIpBytesIn:
                        type: SNMP
                        component: "${here/id}"
                        oid: 1.3.6.1.4.1.30155.1.4.2.0
                        datapoints:
                            pfLogIfIpBytesIn:
                                rrdtype: DERIVE
                    pfLogIfIpBytesOut:
                        type: SNMP
                        component: "${here/id}"
                        oid: 1.3.6.1.4.1.30155.1.4.3.0
                        datapoints:
                            pfLogIfIpBytesOut:
                                rrdtype: DERIVE
                    pfLogIfIpPktsInPass:
                        type: SNMP
                        component: "${here/id}"
                        oid: 1.3.6.1.4.1.30155.1.4.4.0
                        datapoints:
                            pfLogIfIpPktsInPass:
                                rrdtype: DERIVE
                    pfLogIfIpPktsInDrop:
                        type: SNMP
                        component: "${here/id}"
                        oid: 1.3.6.1.4.1.30155.1.4.5.0
                        datapoints:
                            pfLogIfIpPktsInDrop:
                                rrdtype: DERIVE
                    pfLogIfIpPktsOutPass:
                        type: SNMP
                        component: "${here/id}"
                        oid: 1.3.6.1.4.1.30155.1.4.6.0
                        datapoints:
                            pfLogIfIpPktsOutPass:
                                rrdtype: DERIVE
                    pfLogIfIpPktsOutDrop:
                        type: SNMP
                        component: "${here/id}"
                        oid: 1.3.6.1.4.1.30155.1.4.7.0
                        datapoints:
                            pfLogIfIpPktsOutDrop:
                                rrdtype: DERIVE
                    pfLogIfIp6BytesIn:
                        type: SNMP
                        component: "${here/id}"
                        oid: 1.3.6.1.4.1.30155.1.4.8.0
                        datapoints:
                            pfLogIfIp6BytesIn:
                                rrdtype: DERIVE
                    pfLogIfIp6BytesOut:
                        type: SNMP
                        component: "${here/id}"
                        oid: 1.3.6.1.4.1.30155.1.4.9.0
                        datapoints:
                            pfLogIfIp6BytesOut:
                                rrdtype: DERIVE
                    pfLogIfIp6PktsInPass:
                        type: SNMP
                        component: "${here/id}"
                        oid: 1.3.6.1.4.1.30155.1.4.10.0
                        datapoints:
                            pfLogIfIp6PktsInPass:
                                rrdtype: DERIVE
                    pfLogIfIp6PktsInDrop:
                        type: SNMP
                        component: "${here/id}"
                        oid: 1.3.6.1.4.1.30155.1.4.11.0
                        datapoints:
                            pfLogIfIp6PktsInDrop:
                                rrdtype: DERIVE
                    pfLogIfIp6PktsOutPass:
                        type: SNMP
                        component: "${here/id}"
                        oid: 1.3.6.1.4.1.30155.1.4.12.0
                        datapoints:
                            pfLogIfIp6PktsOutPass:
                                rrdtype: DERIVE
                    pfLogIfIp6PktsOutDrop:
                        type: SNMP
                        component: "${here/id}"
                        oid: 1.3.6.1.4.1.30155.1.4.13.0
                        datapoints:
                            pfLogIfIp6PktsOutDrop:
                                rrdtype: DERIVE
                    pfSrcTrackCount:
                        type: SNMP
                        component: "${here/id}"
                        oid: 1.3.6.1.4.1.30155.1.5.1.0
                        datapoints:
                            pfLogIfIp6PktsOutDrop:
                                rrdtype: DERIVE
                    pfSrcTrackSearches:
                        type: SNMP
                        component: "${here/id}"
                        oid: 1.3.6.1.4.1.30155.1.5.2.0
                        datapoints:
                            pfSrcTrackSearches:
                                rrdtype: DERIVE
                    pfSrcTrackInserts:
                        type: SNMP
                        component: "${here/id}"
                        oid: 1.3.6.1.4.1.30155.1.5.3.0
                        datapoints:
                            pfSrcTrackInserts:
                                rrdtype: DERIVE
                    pfSrcTrackRemovals:
                        type: SNMP
                        component: "${here/id}"
                        oid: 1.3.6.1.4.1.30155.1.5.4.0
                        datapoints:
                            pfSrcTrackRemovals:
                                rrdtype: DERIVE

                graphs:
                    "States":
                        units: "states"
                        graphpoints:
                            States:
                                dpName: pfStateCount_pfStateCount
                                format: "%8.2lf"

                    "State Operations":
                        units: "ops/sec"
                        graphpoints:
                            Searches:
                                dpName: pfStateSearches_pfStateSearches
                                format: "%8.2lf"
                            Inserts:
                                dpName: pfStateInserts_pfStateInserts
                                format: "%8.2lf"
                            Removals:
                                dpName: pfStateRemovals_pfStateRemovals
                                format: "%8.2lf"

                    "Dropped Packets":
                        units: "packets/sec"
                        graphpoints:
                            "Memory Limits":
                                dpName: pfCntMemory_pfCntMemory
                                format: "%5.2lf"
                            "Bad Timestamp":
                                dpName: pfCntTimestamp_pfCntTimestamp
                                format: "%5.2lf"
                            "Congestion":
                                dpName: pfCntCongestion_pfCntCongestion
                                format: "%5.2lf"
                            "IP Options":
                                dpName: pfCntIpOption_pfCntIpOption
                                format: "%5.2lf"
                            "Bad Checksum":
                                dpName: pfCntProtoCksum_pfCntProtoCksum
                                format: "%5.2lf"
                            "State Mismatch":
                                dpName: pfCntStateMismatch_pfCntStateMismatch
                                format: "%5.2lf"
                            "State Insert Error":
                                dpName: pfCntStateInsert_pfCntStateInsert
                                format: "%5.2lf"
                            "Per-Rule State Limit":
                                dpName: pfCntStateLimit_pfCntStateLimit
                                format: "%5.2lf"
                            "Per-Source State Limit":
                                dpName: pfCntSrcLimit_pfCntSrcLimit
                                format: "%5.2lf"
                            "Synproxy":
                                dpName: pfCntSynproxy_pfCntSynproxy
                                format: "%5.2lf"
                            "NAT - No Unused Port":
                                dpName: pfCntTranslate_pfCntTranslate
                                format: "%5.2lf"
                            "No Route":
                                dpName: pfCntNoRoute_pfCntNoRoute
                                format: "%5.2lf"

                    Log Interface - Bytes:
                        units: bytes
                        graphpoints:
                            "IPv4 In":
                                dpName: pfLogIfIpBytesIn_pfLogIfIpBytesIn
                                format: "%6.2lf%s"
                            "IPv4 Out":
                                dpName: pfLogIfIpBytesOut_pfLogIfIpBytesOut
                                format: "%6.2lf%s"
                            "IPv6 In":
                                dpName: pfLogIfIp6BytesIn_pfLogIfIp6BytesIn
                                format: "%6.2lf%s"
                            "IPv6 Out":
                                dpName: pfLogIfIp6BytesOut_pfLogIfIp6BytesOut
                                format: "%6.2lf%s"

                    "Log Interface - Packets":
                        units: bytes
                        graphpoints:
                            "IPv4 Pkts In (Pass)":
                                dpName: pfLogIfIpPktsInPass_pfLogIfIpPktsInPass
                                format: "%6.2lf%s"
                            "IPv4 Pkts In (Drop)":
                                dpName: pfLogIfIpPktsInDrop_pfLogIfIpPktsInDrop
                                format: "%6.2lf%s"
                            "IPv4 Pkts Out (Pass)":
                                dpName: pfLogIfIpPktsOutPass_pfLogIfIpPktsOutPass
                                format: "%6.2lf%s"
                            "IPv4 Pkts Out (Drop)":
                                dpName: pfLogIfIpPktsOutDrop_pfLogIfIpPktsOutDrop
                                format: "%6.2lf%s"
                            "IPv6 Pkts In (Pass)":
                                dpName: pfLogIfIp6PktsInPass_pfLogIfIp6PktsInPass
                                format: "%6.2lf%s"
                            "IPv6 Pkts In (Drop)":
                                dpName: pfLogIfIp6PktsInDrop_pfLogIfIp6PktsInDrop
                                format: "%6.2lf%s"
                            "IPv6 Pkts Out (Pass)":
                                dpName: pfLogIfIp6PktsOutPass_pfLogIfIp6PktsOutPass
                                format: "%6.2lf%s"
                            "IPv6 Pkts Out (Drop)":
                                dpName: pfLogIfIp6PktsOutDrop_pfLogIfIp6PktsOutDrop
                                format: "%6.2lf%s"

                    "Source Tracking Table - Entries":
                        units: entries
                        graphpoints:
                            Entries:
                                dpName: pfSrcTrackCount_pfSrcTrackCount
                                format: "%6.2lf%s"

                    "Source Tracking Table - Operations":
                        units: ops/sec
                        graphpoints:
                            Searches:
                                dpName: pfSrcTrackSearches_pfSrcTrackSearches
                                format: "%6.2lf%s"
                            Inserts:
                                dpName: pfSrcTrackInserts_pfSrcTrackInserts
                                format: "%6.2lf%s"
                            Removals:
                                dpName: pfSrcTrackRemovals_pfSrcTrackRemovals
                                format: "%6.2lf%s"

